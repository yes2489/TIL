# OSI 7계층

## OSI 7계층 개요
 - Open Systems Interconnection 7 Layer의 약어로 국제 표준화 기구(ISO)에서 개발한 **표준화된 네트워크 구조 모델**
 - 7개의 계층으로 존재, 서로 독립적

## OSI 7계층의 데이터 전송
### 캡슐화 (Encapsulation)
 - **송신** 측에서 데이터를 보낼 때 데이터의 앞부분에 본인 계층의 정보(헤더)를 붙여 다음 계층으로 전송
### 역캡슐화 (Decapsulation)
 - **수신** 측에서 자기 계층에 해당하는 헤더를 읽고 해석
### 캡슐화 & 역캡슐화의 장점
 1. 각 계층에 맞는 헤더만 해석되기 때문에 목적에 부합하는 기능만 수행
 2. 동일 계층 간 표준화된 인터페이스 유지

## 물리 계층
 - **전기 신호**로 변환된 데이터들을 전송 매체를 이용해 전달
 - 신호의 전압, 타이밍, 전송 속도, 커넥터 규격 등 물리적 특성을 정의
 - 장비: 리피터, 더미 허브
 - PDU: `Bit`

## 데이터 링크 계층
 - **MAC 주소** (네트워크 인터페이스에 부여된 물리 주소)를 사용하여 통신
 - Point to Point 간 데이터 전송을 담당하며 흐름 제어, 오류 제어 기능이 존재
 - 장비: 스위치
 - PDU: `Frame` - 헤더, 데이터(페이로드), 트레일러로 구성
### ARP
 - 네트워크 계층의 IP 주소를 데이터 링크 계층의 MAC 주소로 변환하기 위한 프로토콜
 - 동작 방식
    ```
    [통신 대상 IP가 동일 대역일 경우]
    1) ARP 테이블 조회
    2) 매핑 정보가 없으면 ARP Request를 브로드캐스트로 전송
    3) 해당 IP를 가진 호스트는 자신의 MAC 주소를 담은 ARP Reply를 유니캐스트로 응답 (해당 정보는 ARP 테이블에 캐시 되어 이후 사용 됨)
    ```

## 네트워크 계층
 - IP를 사용하여 서로 다른 네트워크 간 데이터 전달을 담당
 - IP를 기반으로 라우팅 수행
 - 신뢰성은 보장하지 않는 Best-Effort 전송
 - 장비: 라우터
 - PDU: `Packet`
### IP (Internet Protocol)
 - 네트워크 간 통신을 위해 부여되는 논리 주소
### 단편화(Fragment)
 - 커다란 패킷을 MTU에 맞게 분할하여 보내는 작업
 - IP 헤더의 identification과 IP Flags, Fragment offset을 이용
### Best-Effort 전송
 - 네트워크가 패킷 전달 시도는 하지만 전송 성공, 순서, 중복, 재전송을 보장하지 않는 방식

## 전송 계층
 - TCP나 UDP에서 어플리케이션이 상호 통신을 위해 `Port`라는 가상의 논리적 통신 연결단을 사용
 - 데이터가 제대로 도착했는지 확인
 - 데이터가 최종적으로 도착할 어플리케이션이 무엇인지 식별
 - PDU: `Segment`
### TCP & UDP
| 구분 | TCP | UDP |
|:---:|:---|:---|
| 신뢰성 | **O**: 패킷이 목적지에 도달했는지 확인, 도달할 때 마다 ACK 패킷을 수신하기 때문 | **X**: 패킷이 목적지에 도달했는지 미확인|
| 연결 | **연결 지향**: 세션 성립 및 종료 시 HandShake 과정 수행, 목적지와 세션 성립 | **비연결 지향**: 세션 성립 및 종료 시 HandShake 미수행 |
| 패킷 순서 | **순서 번호와 ACK**를 사용해 순서를 보장하며, 유실된 세그먼트만 재전송 | 전송 계층에서 순서 보장을 하지 않음 |
| 주 사용 | **HTTP, SSH, FTP** 등 신뢰성이 필요한 통신에서 주로 사용 | 실시간 영상, 브로드캐스트 등 **빠른 통신** 필요 시 사용 |
### TCP 3-Way Handshake
 1. 서버는 서비스할 PORT를 열어놓고 Client의 접속을 대기 (closed → listen)
 2. Client는 서버에게 접속 요청하는 SYN 발신 (closed → SYN sent)
 3. 서버는 Client에게 SYN + ACK 발신 (listen → SYN rcvd)
 4. Client는 서버에게 ACK 발신 (SYN sent → established)
 5. 세션 성립 (서버측 SYN rcvd → established)

## 세션 계층
 - 통신을 수행하는 두 호스트 간의 **세션(연결 상태)을 생성, 유지, 종료**하는 역할
 - 데이터 교환 순서 제어 및 동기화 지점 관리
 - 통신 중 장애 발생 시 세션 복구 지원
 - PDU: `Data`

## 표현 계층
 - 상위 계층과 하위 계층 간 **데이터 표현 방식 차이를 해결**
 - 데이터 형식 변환, 인코딩/디코딩, 압축, 암호화 수행
 - 서로 다른 시스템 간 동일한 데이터 해석을 보장
 - PDU: `Data`

## 응용 계층
 - 사용자가 직접 사용하는 네트워크 서비스 제공
 - 애플리케이션에서 네트워크 기능을 사용할 수 있도록 서비스 제공
 - 대표 프로토콜 : HTTP, FTP, SMTP, DNS, SSH 등
 - PDU: `Data`